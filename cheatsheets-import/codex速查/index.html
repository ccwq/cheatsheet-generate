<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>codex速查</title>
</head>
<body>
<meta charset="UTF-8">
  <title>Codex CLI 速查表</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}:root{--primary-color:#8250df;--bg-color:#ffffff;--text-color:#24292f;--border-color:#d0d7de;--code-bg:#f6f8fa;--sidebar-bg:#f6f8fa;--card-shadow:rgba(149, 157, 165, 0.2)}body{background:var(--bg-color);color:var(--text-color);font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji';font-size:12px;line-height:1.4;min-height:100vh;padding:15px}h1, h2, h3{color:var(--text-color);margin-top:0;position:relative;font-weight:600}h1{font-size:1.5rem;text-align:center;margin:15px 0 20px;padding-bottom:10px}h1::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:120px;height:1px;background:var(--primary-color)}h2{font-size:1.1rem;margin:12px 0 8px;padding-bottom:5px;border-bottom:1px solid var(--border-color);color:var(--primary-color)}h3{font-size:1rem;margin:10px 0 5px;color:var(--primary-color)}.container{column-count:4;column-gap:15px;max-width:100%;margin:0 auto;padding:0 5px 25px;transition:column-width 0.2s}@media (max-width: 1100px){.container{column-count:3}}@media (max-width: 800px){.container{column-count:2}}@media (max-width: 500px){.container{column-count:1}}.card{background:var(--bg-color);border:1px solid var(--border-color);border-radius:6px;box-shadow:0 1px 3px 0 var(--card-shadow);margin-bottom:12px;padding:12px;break-inside:avoid;position:relative;overflow:hidden}.card::before{content:"";position:absolute;top:0;left:0;width:100%;height:2px;background:var(--primary-color)}.code-block{background:var(--code-bg);color:var(--text-color);border:1px solid var(--border-color);border-radius:3px;padding:8px;font-size:11px;font-family:ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;line-height:1.3;margin:8px 0 5px;overflow-x:auto;white-space:pre;position:relative}.slider-box{margin:10px auto 15px;max-width:350px;display:flex;flex-direction:row;align-items:center;background:var(--sidebar-bg);border:1px solid var(--border-color);border-radius:15px;padding:8px 15px;box-shadow:0 1px 2px rgba(0, 0, 0, 0.05)}.slider-box span{font-size:12px;margin:0 8px 0 0;color:var(--text-color);font-weight:600}.slider{width:150px;-webkit-appearance:none;height:5px;background:var(--border-color);outline:none;border-radius:2px}.slider::-webkit-slider-thumb{-webkit-appearance:none;width:15px;height:15px;background:var(--primary-color);cursor:pointer;border-radius:50%;box-shadow:0 1px 2px rgba(0, 0, 0, 0.2)}::selection{background:rgba(130, 80, 223, 0.3)}.desc{font-size:11px;color:#57606a;margin:6px 0;padding:6px 8px;border-left:2px solid var(--primary-color);background:var(--code-bg);border-radius:0 3px 3px 0}ul{padding-left:16px;margin:8px 0}li{margin-bottom:5px;position:relative;padding-left:15px}li::before{content:"•";position:absolute;left:0;color:var(--primary-color);font-size:1em;line-height:1}a{color:#0969da;text-decoration:none;border-bottom:1px dotted var(--border-color);padding:1px 0;transition:all 0.3s}a:hover{color:#0550ae;border-bottom:1px solid var(--primary-color)}a:visited{color:#6a5a8a}#colShow{font-weight:600;color:var(--primary-color)}.card::after{content:"";position:absolute;bottom:0;right:0;width:20px;height:20px;background:linear-gradient(135deg, transparent 50%, var(--code-bg) 50%);pointer-events:none}
  </style>


  <h1>Codex CLI 速查表</h1>
  <div class="slider-box">
    <span>列宽:</span>
    <input class="slider" id="colWidthSlider" type="range" min="250" max="500" value="300" oninput="resizeColumn(this.value)">
    <span id="colShow">300px</span>
  </div>
  <div class="container" id="container">
    
    <div class="card">
      <h2>安装和启动</h2>
      <h3>安装方式</h3>
      <div class="code-block"># npm 安装
npm install -g @openai/codex
 
# Homebrew 安装
brew install codex</div>
      
      <h3>基本启动</h3>
      <div class="code-block"># 交互式 TUI
codex
 
# 带初始提示启动
codex "修复代码中的 lint 错误"</div>
      
      <h3>会话恢复</h3>
      <div class="code-block"># 打开会话选择器
codex resume
 
# 恢复最近会话
codex resume --last
 
# 恢复指定会话
codex resume 7f9f9a2e-1b3c-4c7a-9b0e-123456789abc</div>
      
      <div class="desc">支持多种安装方式，推荐使用 npm 或 Homebrew。会话恢复功能允许继续之前的对话。</div>
    </div>
    
    <div class="card">
      <h2>核心命令</h2>
      <h3>主要命令</h3>
      <div class="code-block"># 交互式 TUI
codex
 
# 带提示的交互模式
codex "提示内容"
 
# 非交互式自动化模式
codex exec "提示内容"</div>
      
      <h3>常用标志</h3>
      <div class="code-block">--model/-m MODEL           # 指定模型
--ask-for-approval/-a POLICY  # 设置审批策略
--sandbox MODE               # 沙盒模式
--full-auto                 # 全自动模式
--cd/-C DIR                 # 指定工作目录</div>
      
      <h3>实用命令</h3>
      <div class="code-block"># 生成 shell 补全
codex completion bash
codex completion zsh
codex completion fish
 
# MCP 服务器管理
codex mcp add NAME -- COMMAND
codex mcp list
codex mcp remove NAME</div>
      
      <div class="desc">支持交互式和非交互式两种模式，具有丰富的命令行选项和配置能力。</div>
    </div>
    
    <div class="card">
      <h2>模型配置</h2>
      <h3>模型选择</h3>
      <div class="code-block"># config.toml 配置
model = "o3"                    # 默认 gpt-5-codex
model_provider = "openai"      # 默认 openai</div>
      
      <h3>模型提供商</h3>
      <div class="code-block">[model_providers.openai-chat-completions]
name = "OpenAI using Chat Completions"
base_url = "https://api.openai.com/v1"
env_key = "OPENAI_API_KEY"
wire_api = "chat"
 
[model_providers.ollama]
name = "Ollama"
base_url = "http://localhost:11434/v1"</div>
      
      <h3>推理配置</h3>
      <div class="code-block">model_reasoning_effort = "high"    # minimal/low/medium/high
model_reasoning_summary = "detailed" # auto/concise/detailed
model_verbosity = "medium"          # low/medium/high</div>
      
      <div class="desc">支持多种模型和提供商，可配置推理努力程度和输出详细程度。</div>
    </div>
    
    <div class="card">
      <h2>沙盒和审批</h2>
      <h3>沙盒模式</h3>
      <div class="code-block">sandbox_mode = "read-only"          # 只读
sandbox_mode = "workspace-write"    # 工作区可写
sandbox_mode = "danger-full-access" # 完全访问</div>
      
      <h3>审批策略</h3>
      <div class="code-block">approval_policy = "untrusted"       # 不可信命令需审批
approval_policy = "on-failure"      # 失败时需审批
approval_policy = "on-request"      # 按需审批
approval_policy = "never"           # 从不审批</div>
      
      <h3>常用组合</h3>
      <div class="code-block"># 安全浏览
codex --sandbox read-only --ask-for-approval on-request
 
# 自动模式
codex --full-auto
# 等同于:
codex --sandbox workspace-write --ask-for-approval on-failure</div>
      
      <div class="desc">提供多层安全保护，支持细粒度的权限控制和审批流程。</div>
    </div>
    
    <div class="card">
      <h2>配置文件</h2>
      <h3>配置位置</h3>
      <div class="code-block"># 主配置文件
~/.codex/config.toml
 
# 全局指令
~/.codex/AGENTS.md
 
# 项目级指令
./AGENTS.md</div>
      
      <h3>配置优先级</h3>
      <div class="code-block">1. 命令行参数 (最高)
2. 配置文件中的 profile
3. config.toml 中的设置
4. 默认值 (最低)</div>
      
      <h3>Profile 配置</h3>
      <div class="code-block">[profiles.full_auto]
model = "o3"
approval_policy = "on-request"
sandbox_mode = "workspace-write"
 
# 使用 profile
codex --profile full_auto</div>
      
      <div class="desc">支持多层级配置，Profile 功能便于快速切换不同的使用场景。</div>
    </div>
    
    <div class="card">
      <h2>高级功能</h2>
      <h3>非交互模式</h3>
      <div class="code-block"># CI/CD 使用
codex exec --full-auto "更新版本日志"
 
# 恢复非交互会话
codex exec "继续任务" resume --last</div>
      
      <h3>MCP 集成</h3>
      <div class="code-block">[mcp_servers.docs-server]
command = "npx"
args = ["-y", "mcp-server-docs"]
env = { "API_KEY" = "value" }
startup_timeout_sec = 20
tool_timeout_sec = 30</div>
      
      <h3>日志和调试</h3>
      <div class="code-block"># 监控日志
tail -F ~/.codex/log/codex-tui.log
 
# 设置日志级别
RUST_LOG=codex_core=debug,codex_tui=info codex</div>
      
      <div class="desc">支持 CI/CD 集成、MCP 服务器扩展和详细的日志调试功能。</div>
    </div>
    
    <div class="card">
      <h2>使用技巧</h2>
      <h3>文件搜索</h3>
      <div class="code-block"># 输入 @ 触发模糊文件搜索
@utils.js  # 搜索 utils.js 文件</div>
      
      <h3>图像输入</h3>
      <div class="code-block"># 命令行指定图像
codex -i screenshot.png "解释这个错误"
 
# 多个图像
codex --image img1.png,img2.jpg "总结这些图表"</div>
      
      <h3>编辑历史消息</h3>
      <div class="code-block"># 在空编辑器中按 Esc 进入回溯模式
# 再次按 Esc 编辑上一条消息
# 按 Enter 确认编辑</div>
      
      <div class="desc">提供便捷的文件搜索、图像输入和消息编辑功能，提升使用体验。</div>
    </div>
    
    <div class="card">
      <h2>示例提示</h2>
      <h3>代码重构</h3>
      <div class="code-block">codex "将 Dashboard 组件重构为 React Hooks"</div>
      
      <h3>测试生成</h3>
      <div class="code-block">codex "为 utils/date.ts 编写单元测试"</div>
      
      <h3>文件操作</h3>
      <div class="code-block">codex "批量重命名 *.jpeg -> *.jpg 使用 git mv"</div>
      
      <h3>代码解释</h3>
      <div class="code-block">codex "解释这个正则表达式: ^(?=.*[A-Z]).{8,}$"</div>
      
      <h3>安全审查</h3>
      <div class="code-block">codex "查找漏洞并创建安全审查报告"</div>
      
      <div class="desc">提供丰富的实际应用示例，涵盖代码开发、测试和维护的各个方面。</div>
    </div>
    
    <div class="card">
      <h2>环境策略</h2>
      <h3>环境变量控制</h3>
      <div class="code-block">[shell_environment_policy]
inherit = "core"               # all/core/none
ignore_default_excludes = false
exclude = ["AWS_*", "AZURE_*"]
set = { CI = "1" }
include_only = ["PATH", "HOME"]</div>
      
      <h3>过滤规则</h3>
      <div class="code-block"># 默认排除包含 KEY/SECRET/TOKEN 的变量
# 支持通配符模式匹配
# 大小写不敏感</div>
      
      <h3>常用配置</h3>
      <div class="code-block"># 最小化环境
[shell_environment_policy]
inherit = "none"
set = { PATH = "/usr/bin", MY_FLAG = "1" }
 
# 仅允许特定变量
[shell_environment_policy]
inherit = "all"
include_only = ["PATH", "HOME", "USER"]</div>
      
      <div class="desc">精细控制子进程的环境变量，提供安全的执行环境。</div>
    </div>
    
    <div class="card">
      <h2>通知和监控</h2>
      <h3>桌面通知</h3>
      <div class="code-block">[tui]
notifications = true
notifications = ["agent-turn-complete", "approval-requested"]</div>
      
      <h3>外部通知程序</h3>
      <div class="code-block">notify = ["python3", "/Users/user/.codex/notify.py"]
 
# notify.py 示例
import json
import subprocess
import sys
 
notification = json.loads(sys.argv[1])
if notification.get("type") == "agent-turn-complete":
    subprocess.run(["terminal-notifier", "-title", "Codex 完成", "-message", "任务已完成"])</div>
      
      <h3>历史记录</h3>
      <div class="code-block">[history]
persistence = "none"  # "save-all" 为默认值
 
# 历史文件位置
~/.codex/history.jsonl</div>
      
      <div class="desc">支持多种通知方式和历史记录管理，便于跟踪和监控。</div>
    </div>
    
    <div class="card">
      <h2>网络调优</h2>
      <h3>提供商网络配置</h3>
      <div class="code-block">[model_providers.openai]
name = "OpenAI"
base_url = "https://api.openai.com/v1"
env_key = "OPENAI_API_KEY"
# 网络调优配置
request_max_retries = 4
stream_max_retries = 10
stream_idle_timeout_ms = 300000</div>
      
      <h3>超时配置</h3>
      <div class="code-block">request_max_retries = 4      # HTTP 请求重试次数
stream_max_retries = 10      # 流式响应重连次数
stream_idle_timeout_ms = 300000  # 流空闲超时时间 (5分钟)</div>
      
      <h3>HTTP 头配置</h3>
      <div class="code-block">[model_providers.example]
# 固定 HTTP 头
http_headers = { "X-Example-Header" = "example-value" }
 
# 环境变量 HTTP 头
env_http_headers = { "X-Example-Features" = "EXAMPLE_FEATURES" }</div>
      
      <div class="desc">提供细粒度的网络调优选项，确保稳定的 API 连接和响应。</div>
    </div>
    
    <div class="card">
      <h2>文件操作</h2>
      <h3>文件打开器</h3>
      <div class="code-block">file_opener = "vscode"        # 默认值
# 可选值: vscode, vscode-insiders, windsurf, cursor, none</div>
      
      <h3>项目文档限制</h3>
      <div class="code-block">project_doc_max_bytes = 32768  # 32KB 默认值
 
# 控制 AGENTS.md 文件的最大读取字节数</div>
      
      <h3>工作区配置</h3>
      <div class="code-block">[sandbox_workspace_write]
exclude_tmpdir_env_var = false
exclude_slash_tmp = false
writable_roots = ["/Users/user/.pyenv/shims"]
network_access = false</div>
      
      <div class="desc">支持多种编辑器集成和灵活的文件系统访问控制。</div>
    </div>
    
    <div class="card">
      <h2>推理控制</h2>
      <h3>推理努力程度</h3>
      <div class="code-block">model_reasoning_effort = "minimal"  # 最小推理
model_reasoning_effort = "low"       # 低推理
model_reasoning_effort = "medium"    # 中等推理 (默认)
model_reasoning_effort = "high"      # 高推理</div>
      
      <h3>推理摘要</h3>
      <div class="code-block">model_reasoning_summary = "auto"     # 自动 (默认)
model_reasoning_summary = "concise"  # 简洁
model_reasoning_summary = "detailed" # 详细
model_reasoning_summary = "none"     # 禁用</div>
      
      <h3>输出详细程度</h3>
      <div class="code-block">model_verbosity = "low"    # 低详细度
model_verbosity = "medium" # 中等详细度 (默认)
model_verbosity = "high"   # 高详细度</div>
      
      <div class="desc">精细控制模型的推理过程和输出格式，优化性能和效果。</div>
    </div>
    
    <div class="card">
      <h2>MCP 服务器</h2>
      <h3>作为 MCP 客户端</h3>
      <div class="code-block">[mcp_servers.filesystem]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-filesystem"]
env = { "ALLOWED_PATHS" = "/Users/user/projects" }
 
[mcp_servers.github]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-github"]
env = { "GITHUB_TOKEN" = "your_token" }</div>
      
      <h3>作为 MCP 服务器</h3>
      <div class="code-block"># 启动 Codex MCP 服务器
codex mcp
 
# 使用 MCP 检查器测试
npx @modelcontextprotocol/inspector codex mcp</div>
      
      <h3>MCP 工具</h3>
      <div class="code-block"># codex 工具 - 启动会话
{
  "prompt": "实现一个井字游戏",
  "approval-policy": "never",
  "sandbox": "workspace-write"
}
 
# codex-reply 工具 - 继续会话
{
  "prompt": "添加动画效果",
  "conversationId": "session-id"
}</div>
      
      <div class="desc">支持作为 MCP 客户端和服务器，提供丰富的工具扩展能力。</div>
    </div>
    
    <div class="card">
      <h2>调试工具</h2>
      <h3>沙盒测试</h3>
      <div class="code-block"># macOS
codex debug seatbelt [--full-auto] [COMMAND]...
 
# Linux
codex debug landlock [--full-auto] [COMMAND]...</div>
      
      <h3>状态检查</h3>
      <div class="code-block"># 在 TUI 中使用 /status 命令
/status
 
# 查看工作区、沙盒状态、权限等信息</div>
      
      <h3>配置验证</h3>
      <div class="code-block"># 检查配置文件语法
codex --help
 
# 验证 MCP 服务器配置
codex mcp list</div>
      
      <div class="desc">提供强大的调试和诊断工具，帮助排查配置和运行时问题。</div>
    </div>
    
    <div class="card">
      <h2>平台支持</h2>
      <h3>macOS 支持</h3>
      <div class="code-block"># 使用 Apple Seatbelt 沙盒
# 支持 macOS 12+
# 通过 sandbox-exec 实现</div>
      
      <h3>Linux 支持</h3>
      <div class="code-block"># 使用 Landlock/seccomp API
# 需要 Linux 内核支持
# 在 Docker 中可能需要特殊配置</div>
      
      <h3>容器环境</h3>
      <div class="code-block"># Docker 中使用
# 可能需要禁用原生沙盒
# 使用容器自身的沙盒机制
sandbox_mode = "danger-full-access"</div>
      
      <div class="desc">支持主流操作系统，针对不同平台提供优化的沙盒实现。</div>
    </div>
    
  </div>
  <script>
    function resizeColumn(px){
      let container = document.getElementById('container');
      container.style.columnWidth = px + 'px';
      document.getElementById('colShow').innerText = px + 'px';
      container.style.display = 'none';
      void container.offsetHeight;
      container.style.display = 'block';
    }
    resizeColumn(300);
  </script>
</body>
</html>