<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>COLMAP å½±åƒé‡å»ºé€ŸæŸ¥è¡¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../css/variables.css">
  <link rel="stylesheet" href="../../css/common.css">

  <!-- Prism.js è¯­æ³•é«˜äº® -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

  <style>
    :root {
      --col-width: 400px;
      --gap: 16px;
    }

    .cheat-columns {
      column-count: 4;
    }

    @media (max-width: 1500px) {
      .cheat-columns {
        column-count: 3;
      }
    }

    @media (max-width: 1100px) {
      .cheat-columns {
        column-count: 2;
      }
    }

    @media (max-width: 750px) {
      .cheat-columns {
        column-count: 1;
      }
    }

    .panel label {
      color: #ffe49b;
    }

    .slider-bar {
      min-width: 120px;
    }

    .slider-val {
      min-width: 28px;
    }

    pre code {
      font-size: 13px;
      line-height: 1.2;
    }
  </style>

    <link rel="icon" type="image/png" href="../../assets/brand/cheatsheet.png" />
    <link rel="apple-touch-icon" href="../../assets/brand/cheatsheet.png" />
  </head>
<body>
  <div class="container">
    <div class="panel">
      <span style="color:#7bfbb7;font-size:16px;margin-right:auto;">COLMAP å½±åƒé‡å»ºé€ŸæŸ¥è¡¨ï¼ˆé¢å‘å…¥é—¨å¼€å‘è€…ï¼‰</span>
      <label for="columnWidth">ğŸ”§ è°ƒæ•´æ¯åˆ—å®½åº¦ï¼š</label>
      <input id="columnWidth" class="slider-bar" type="range" min="300" max="660" value="340">
      <span id="widthVal" class="slider-val">340px</span>
    </div>

    <div class="cheat-columns" id="columns">
      <div class="card">
        <h2>ğŸš€ é€Ÿè§ˆä¸ä¸»çº¿æµç¨‹ <a href="https://colmap.github.io/tutorial.html#quickstart" target="_blank" title="Quickstart">>></a></h2>
        <ul>
          <li>COLMAP = å…ˆç¨€ç– SfM æ±‚ç›¸æœºä½å§¿ä¸ç¨€ç–ç‚¹ï¼Œå†ç”¨ MVS å¾—åˆ°ç¨ å¯†ç‚¹äº‘/ç½‘æ ¼ã€‚</li>
          <li>GUI å¿«æ·ï¼š<code>Reconstruction &gt; Automatic Reconstruction</code> æŒ‡å®šå›¾ç‰‡ç›®å½•å³å¯äº§å‡ºç¨€ç–/ç¨ å¯†ç»“æœã€‚</li>
          <li>æ¨èå…ˆè·‘è‡ªåŠ¨é‡å»ºçœ‹ç»“æœï¼Œå†æŒ‰éœ€ç”¨æ‰‹åŠ¨æµæ°´çº¿å¾®è°ƒå‚æ•°ã€‚</li>
        </ul>
        <h3>å…¸å‹è¾“å‡ºç»“æ„</h3>
        <pre><code class="language-text">project/
â”œâ”€ images/...
â”œâ”€ database.db
â”œâ”€ sparse/0/{cameras.bin,images.bin,points3D.bin,...}
â””â”€ dense/0/{images,sparse,stereo,fused.ply,meshed-poisson.ply,meshed-delaunay.ply}</code></pre>
        <div class="desc">åˆå­¦è€…å…ˆè·‘è‡ªåŠ¨é‡å»ºï¼Œç¡®è®¤æµç¨‹é€šè·¯ä¸ç¡¬ä»¶æ€§èƒ½ï¼Œå†è½¬åˆ°æ‰‹åŠ¨ CLI ç»†åŒ–ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ“– åŸºç¡€æ¦‚å¿µé‡Šä¹‰ <a href="https://colmap.github.io/tutorial.html#terminology" target="_blank" title="Terminology">>></a></h2>
        <ul>
          <li><b>ç›¸æœº(Camera)</b>ï¼šåŒä¸€ç‰©ç†æœºä½/é•œå¤´/ç„¦æ®µçš„å†…å‚æ¨¡å‹ï¼Œå¯å¯¹åº”å¤šå¼ å›¾ç‰‡ã€‚</li>
          <li><b>å›¾åƒ(Image)</b>ï¼šç£ç›˜ä¸Šçš„å•å¼ ç…§ç‰‡ï¼›åŒ…å«å¤–å‚ã€å…³è”ç›¸æœºå†…å‚ã€‚</li>
          <li><b>ç‰¹å¾/æè¿°å­</b>ï¼šSIFT ç­‰å±€éƒ¨ç‰¹å¾ï¼›åŒ¹é…åç»å‡ ä½•éªŒè¯æˆä¸º <b>å†…ç‚¹åŒ¹é…</b>ã€‚</li>
          <li><b>SfM</b>ï¼šç”±åŒ¹é…æ¢å¤ç›¸æœºä½å§¿ä¸ç¨€ç– 3D ç‚¹ã€‚</li>
          <li><b>MVS</b>ï¼šåœ¨å·²çŸ¥ä½å§¿ä¸Šåšé€åƒç´ æ·±åº¦/æ³•çº¿ä¼°è®¡å¹¶èåˆï¼Œå¾—åˆ°ç¨ å¯†ç‚¹äº‘/ç½‘æ ¼ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ“· é‡‡é›†ä¸æ•°æ®ç»„ç»‡ <a href="https://colmap.github.io/tutorial.html#data-structure" target="_blank" title="Data structure">>></a></h2>
        <ul>
          <li>ä¿æŒå›¾ç‰‡æ”¾åœ¨å•ä¸€ <code>images/</code> ç›®å½•ï¼ˆå¯å«å­ç›®å½•ï¼‰ï¼›å…¶ä»–æ–‡ä»¶åˆ†ç¦»ä»¥å… IO å¹²æ‰°ã€‚</li>
          <li>æ‹æ‘„å»ºè®®ï¼šæœ‰çº¹ç†ã€å…‰ç…§ä¸€è‡´ã€è§†è§’è¦†ç›–ä¸”æœ‰é‡å ï¼ˆâ‰¥3 å¼ çœ‹åˆ°åŒç‰©ä½“ï¼‰ã€‚</li>
          <li>é¿å…åªåŸåœ°è½¬èº«æ‹æ‘„ï¼›ç§»åŠ¨æœºä½è·å–è§†å·®ï¼Œæ›´åˆ©äºä¸‰è§’åŒ–ã€‚</li>
          <li>ç”¨è§†é¢‘å¸§æ—¶å¯é™å¸§ï¼Œå‡å°‘å†—ä½™å¹¶èŠ‚çœåŒ¹é…æ—¶é—´ã€‚</li>
        </ul>
        <pre><code class="language-bash"># æ–°å»ºé¡¹ç›®å¸¸è§ä¸‰ä»¶å¥—
/path/to/project/
â”œâ”€ images/          # åŸå§‹å›¾
â”œâ”€ database.db      # SQLite å­˜ç‰¹å¾/åŒ¹é…
â””â”€ project.ini      # GUI ä¿å­˜çš„é¡¹ç›®é…ç½®ï¼Œå¯è¢« --project_path å¤ç”¨</code></pre>
      </div>

      <div class="card">
        <h2>ğŸ–¥ï¸ GUI å¿«é€Ÿæ“ä½œ <a href="https://colmap.github.io/gui.html#gui" target="_blank" title="GUI">>></a></h2>
        <ul>
          <li><code>File &gt; New project</code> é€‰å›¾ç‰‡ç›®å½•ä¸æ•°æ®åº“è·¯å¾„ï¼Œä¿å­˜ <code>.ini</code> ä¾¿äºå¤ç”¨ã€‚</li>
          <li><code>Processing &gt; Extract features</code>ï¼šé€‰ç›¸æœºæ¨¡å‹ï¼ŒEXIF è‡ªåŠ¨è¯»ç„¦è·ï¼Œé»˜è®¤å³å¯ã€‚</li>
          <li><code>Processing &gt; Feature matching</code>ï¼šæŒ‰æ•°æ®é‡é€‰ Exhaustive/Sequential/Vocab Treeã€‚</li>
          <li><code>Reconstruction &gt; Start</code>ï¼šè¿è¡Œå¢é‡ SfMï¼Œå¯åœ¨å·¥å…·æ é€‰æ‹©/åˆå¹¶å¤šæ¨¡å‹ã€‚</li>
          <li><code>Reconstruction &gt; Multi-view stereo</code>ï¼šä¾æ¬¡ undistort â†’ stereo â†’ fuse â†’ meshingã€‚</li>
          <li><code>Processing &gt; Manage database</code>ï¼šæ£€æŸ¥/ä¿®æ”¹ç›¸æœºåˆ†ç»„ã€åŒ¹é…è´¨é‡ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>âŒ¨ï¸ CLI è‡ªåŠ¨/æ‰‹åŠ¨æµæ°´çº¿ <a href="https://colmap.github.io/cli.html#cli" target="_blank" title="CLI">>></a></h2>
        <ul>
          <li>è‡ªåŠ¨ä¸€é”®ï¼š<code>colmap automatic_reconstructor --workspace_path $DATASET --image_path $DATASET/images</code></li>
          <li>æ‰‹åŠ¨å¯æ§ï¼šå…¸å‹ 8 æ­¥ï¼Œä¾¿äºåœ¨ä¸­é—´æ£€æŸ¥/è°ƒå‚/é‡è·‘ã€‚</li>
        </ul>
        <pre><code class="language-bash">DATASET=/path/to/project

colmap feature_extractor \
  --database_path $DATASET/database.db \
  --image_path $DATASET/images

colmap exhaustive_matcher \
  --database_path $DATASET/database.db

mkdir -p $DATASET/sparse
colmap mapper \
  --database_path $DATASET/database.db \
  --image_path $DATASET/images \
  --output_path $DATASET/sparse

mkdir -p $DATASET/dense
colmap image_undistorter \
  --image_path $DATASET/images \
  --input_path $DATASET/sparse/0 \
  --output_path $DATASET/dense \
  --output_type COLMAP \
  --max_image_size 2000

colmap patch_match_stereo \
  --workspace_path $DATASET/dense \
  --workspace_format COLMAP \
  --PatchMatchStereo.geom_consistency true

colmap stereo_fusion \
  --workspace_path $DATASET/dense \
  --workspace_format COLMAP \
  --input_type geometric \
  --output_path $DATASET/dense/fused.ply

colmap poisson_mesher \
  --input_path $DATASET/dense/fused.ply \
  --output_path $DATASET/dense/meshed-poisson.ply</code></pre>
        <div class="desc">æ— æ˜¾ç¤ºç¯å¢ƒæ—¶å¯ç”¨ <code>--FeatureExtraction.use_gpu 0</code> / <code>--FeatureMatching.use_gpu 0</code> å¼ºåˆ¶ CPUã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ” ç‰¹å¾æå–è¦ç‚¹ <a href="https://colmap.github.io/tutorial.html#feature-detection-and-extraction" target="_blank" title="Feature extraction">>></a></h2>
        <ul>
          <li>é»˜è®¤ç”¨ GPU SIFTï¼ŒæœåŠ¡å™¨æ— æ˜¾ç¤ºå¯åˆ‡ CPUï¼›é«˜åå·®åœºæ™¯ GPU ç‰ˆè´¨é‡æ›´å¥½ã€‚</li>
          <li>EXIF ç¼ºå¤±æ—¶ä¼šå°è¯•ç›¸æœºåº“æ¨æ–­ç„¦è·ï¼›åŒæœºåŒç„¦æ®µå»ºè®®å…±äº«å†…å‚ï¼ˆsingle_cameraï¼‰ã€‚</li>
          <li>å¯¼å…¥è‡ªæœ‰ç‰¹å¾ï¼šæ¯å¼ å›¾æ—è¾¹æ”¾ <code>.txt</code>ï¼Œç¬¬ä¸€è¡Œ <code>NUM_FEATURES 128</code>ï¼Œåç»­æ¯è¡Œ <code>X Y SCALE ORI D1...D128</code>ã€‚</li>
        </ul>
        <pre><code class="language-text">4 128
1.2 2.3 0.1 0.3 1 2 ... 21
2.2 3.3 1.1 0.3 3 2 ... 32
0.2 1.3 1.1 0.3 3 2 ... 2
1.2 2.3 1.1 0.3 3 2 ... 3</code></pre>
        <div class="desc">è‹¥å…±äº«ç›¸æœºä½†å°ºå¯¸/EXIF ä¸ä¸€è‡´ä¼šå¯¼è‡´å´©æºƒï¼›å¿…è¦æ—¶åˆ†ç»„å»ºæ¨¡ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ¤ ç‰¹å¾åŒ¹é…æ¨¡å¼ <a href="https://colmap.github.io/tutorial.html#feature-matching-and-geometric-verification" target="_blank" title="Feature matching">>></a></h2>
        <ul>
          <li>Exhaustiveï¼šå°è§„æ¨¡ï¼ˆâ‰¤å‡ ç™¾å¼ ï¼‰ä¼˜å…ˆï¼Œè´¨é‡æœ€ä½³ã€‚</li>
          <li>Sequentialï¼šè§†é¢‘/åºåˆ—å¸§ç”¨ï¼Œå«å›ç¯æ£€æµ‹ï¼ˆéœ€ vocab treeï¼‰ã€‚</li>
          <li>Vocab Treeï¼šå¤§è§„æ¨¡æ£€ç´¢å¼åŒ¹é…ï¼Œéœ€é¢„è®­ç»ƒæ ‘ï¼ˆè‡ªåŠ¨ä¸‹è½½æˆ–è‡ªå»ºï¼‰ã€‚</li>
          <li>Spatialï¼šç”¨ GPS/æ‰‹å·¥ä½ç½®ä¿¡æ¯é€‰æœ€è¿‘é‚»åŒ¹é…ã€‚</li>
          <li>Transitiveï¼šåŸºäºå·²æœ‰åŒ¹é…çš„ä¼ é€’è¡¥å…¨ã€‚</li>
          <li>Customï¼šè‡ªå®šä¹‰æˆå¯¹åˆ—è¡¨æˆ–å¯¼å…¥åŒ¹é…ï¼ˆ<code>image1.jpg image2.jpg</code> åè·Ÿç´¢å¼•å¯¹ï¼‰ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ•¸ï¸ ç¨€ç–é‡å»ºï¼ˆSfMï¼‰ <a href="https://colmap.github.io/tutorial.html#sparse-reconstruction" target="_blank" title="Sparse reconstruction">>></a></h2>
        <ul>
          <li><code>Reconstruction &gt; Start</code> æˆ– CLI <code>mapper</code>ï¼Œå¢é‡æ³¨å†Œæ–°å›¾å¹¶ä¸‰è§’åŒ–ç‚¹ã€‚</li>
          <li>è‹¥åˆå§‹åŒ–å¤±è´¥ï¼Œå¯åœ¨ GUI æŒ‡å®šåˆå§‹æˆå¯¹ç…§ç‰‡åé‡è·‘ã€‚</li>
          <li>å¤šæ¨¡å‹è¾“å‡ºå¯ç”¨ <code>model_converter</code> åˆå¹¶ï¼›æ³¨å†Œç‡ä½å¤šåŠæ˜¯åŒ¹é…è¦†ç›–ä¸è¶³ã€‚</li>
          <li>ä¼˜åŒ–æ€è·¯ï¼šå¢åŠ åŒ¹é…ï¼ˆæ›´é«˜è¿‘é‚»æ•°/å›ç¯ï¼‰ï¼Œæˆ–äººå·¥å‰”é™¤æ¨¡ç³Š/é‡å¤å›¾ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ§Š ç¨ å¯†é‡å»ºï¼ˆMVSï¼‰ <a href="https://colmap.github.io/tutorial.html#dense-reconstruction" target="_blank" title="Dense reconstruction">>></a></h2>
        <ul>
          <li>é¡ºåºï¼š<code>undistort</code> â†’ <code>stereo</code> â†’ <code>fuse</code> â†’ <code>meshing</code>ã€‚</li>
          <li>è‹¥ GPU æ˜¾å­˜ä¸è¶³/å¡æ­»ï¼Œè°ƒå° <code>--PatchMatchStereo</code> ç›¸å…³å‚æ•°æˆ–ç”¨ FAQ ä¸­çš„åˆ†å—ç­–ç•¥ã€‚</li>
          <li>æ³•çº¿/ç½‘æ ¼éœ€å¤–éƒ¨å·¥å…·ï¼ˆMeshlabï¼‰æŸ¥çœ‹ï¼›COLMAP GUI ä»…æ˜¾ç¤ºç‚¹äº‘ã€‚</li>
          <li>å¯¼å‡º PMVS/CMP ç­‰æ ¼å¼ï¼š<code>Extras &gt; Undistort images</code> é€‰æ‹©æ‰€éœ€æ ¼å¼ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ“¤ å¯¼å…¥å¯¼å‡ºä¸æ ¼å¼ <a href="https://colmap.github.io/tutorial.html#importing-and-exporting" target="_blank" title="Import/Export">>></a></h2>
        <ul>
          <li><code>File &gt; Export</code> å¯¼å‡ºå½“å‰æ¨¡å‹ï¼›<code>Export all</code> å¯¼å‡ºå…¨éƒ¨ç»„ä»¶ã€‚</li>
          <li>COLMAP è‡ªèº«æ ¼å¼ï¼ˆtxt/binï¼‰ä¾¿äºç»§ç»­é‡å»ºæˆ–åš undistortï¼›ä¹Ÿæ”¯æŒ PLY/Bundler/VRMLã€‚</li>
          <li><code>File &gt; Import</code> å¯é‡æ–°è½½å…¥å·²å¯¼å‡ºçš„æ¨¡å‹æˆ–æ™®é€š PLY ç‚¹äº‘ã€‚</li>
          <li>æ ¼å¼ç»†èŠ‚è§ <a href="https://colmap.github.io/format.html#output-format" target="_blank">Output Format</a>ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ—„ï¸ æ•°æ®åº“ç®¡ç† <a href="https://colmap.github.io/tutorial.html#database-management" target="_blank" title="Database management">>></a></h2>
        <ul>
          <li><code>Processing &gt; Manage database</code> æŸ¥çœ‹/ç¼–è¾‘ç›¸æœºã€å›¾åƒã€åŒ¹é…ã€‚</li>
          <li>å…±äº«å†…å‚ï¼šé€‰å¤šå›¾ <code>Set camera</code>ï¼Œç»Ÿä¸€ <code>camera_id</code>ï¼›<code>prior_focal_length</code> ç½® 1 è¡¨ç¤ºç›¸ä¿¡æ ‡å®šç„¦è·ã€‚</li>
          <li>éœ€è¦æ‰¹é‡æ“ä½œ/å¯¼å…¥è‡ªå®šä¹‰åŒ¹é…ï¼Œå¯ç›´æ¥ç”¨ SQLite æ“ä½œ <code>database.db</code>ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ› ï¸ å¸¸è§é—®é¢˜ä¸æ’æŸ¥ <a href="https://colmap.github.io/tutorial.html#preface" target="_blank" title="Preface">>></a></h2>
        <ul>
          <li>ç¨‹åºå´©æºƒ/æ— è¾“å‡ºï¼šä»å‘½ä»¤è¡Œå¯åŠ¨æŸ¥çœ‹ tracebackï¼Œå¹¶è°ƒé«˜ <code>--log_to_stderr</code> çº§åˆ«ã€‚</li>
          <li>ç¨ å¯†é˜¶æ®µå¡æ­»ï¼šå‚è€ƒ FAQ <a href="https://colmap.github.io/faq.html#faq-dense-timeout" target="_blank">freeze</a> / <a href="https://colmap.github.io/faq.html#faq-dense-memory" target="_blank">memory</a>ï¼Œå‡å°åˆ†è¾¨ç‡æˆ–æ‹†åˆ†åœºæ™¯ã€‚</li>
          <li>åŒ¹é…é€Ÿåº¦æ…¢ï¼šå‡å°‘å›¾ç‰‡æ•°ï¼ˆæŠ½å¸§ï¼‰ã€æ”¹ç”¨ Vocab Tree/Sequentialï¼Œæˆ–è°ƒæ•´åŒ¹é…è¿‘é‚»æ•°ã€‚</li>
        </ul>
      </div>

      <div class="card">
        <h2>ğŸ‘ï¸ å¯è§†åŒ–ä¸å¤–éƒ¨å·¥å…· <a href="https://colmap.github.io/cli.html#visualization" target="_blank" title="Visualization">>></a></h2>
        <ul>
          <li>SfM ç‚¹äº‘ï¼šGUI é‡Œ <code>File &gt; Import Model</code> é€‰ <code>cameras.txt / images.txt / points3D.txt</code> æ‰€åœ¨ç›®å½•ã€‚</li>
          <li>ç¨ å¯†ç‚¹äº‘ï¼š<code>File &gt; Import Model from...</code> é€‰æ‹© <code>fused.ply</code>ã€‚</li>
          <li>ç½‘æ ¼ï¼š<code>meshed-*.ply</code> éœ€ Meshlab ç­‰å¤–éƒ¨æŸ¥çœ‹ã€‚</li>
        </ul>
      </div>
    </div>
  </div>

  <script src="../../assets/common.js"></script>
  <script>
    // Prism.js ä»£ç é«˜äº®åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      if (window.Prism) {
        Prism.highlightAll();
      }
    });
  </script>
</body>
</html>
