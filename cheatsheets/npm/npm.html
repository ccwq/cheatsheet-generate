<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>npm ä¸ npx åŒ…ç®¡ç†é€ŸæŸ¥è¡¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../css/variables.css">
  <link rel="stylesheet" href="../../css/common.css">
  <link rel="icon" type="image/png" href="../../assets/brand/cheatsheet.png" />
  <link rel="apple-touch-icon" href="../../assets/brand/cheatsheet.png" />
  <style>
    :root {
      /* æ§åˆ¶å¤šåˆ—å¸ƒå±€çš„åˆ—å®½ä¸é—´è·ï¼ˆä¸ _example æ¨¡æ¿ä¿æŒä¸€è‡´ï¼‰ */
      --col-width: 340px;
      --gap: 16px;
    }

    .panel label {
      color: var(--panel-accent);
    }

    .panel .title {
      color: var(--panel-accent);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <span class="title">ğŸ“¦ npm ä¸ npx åŒ…ç®¡ç†é€ŸæŸ¥è¡¨</span>
      <label for="columnWidth">ğŸ”§ è°ƒæ•´æ¯åˆ—å®½åº¦ï¼š</label>
      <input id="columnWidth" class="slider-bar" type="range" min="300" max="660" value="340">
      <span id="widthVal" class="slider-val">340px</span>
    </div>

    <div class="cheat-columns" id="columns">
      <div class="card">
        <h2>ğŸš€ åŸºç¡€å‘½ä»¤ä¸å¸®åŠ© <a href="https://docs.npmjs.com/cli" title="npm CLI æ–‡æ¡£é¦–é¡µ" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm -v</code> | æŸ¥çœ‹ npm ç‰ˆæœ¬</li>
          <li><code>npm --help</code> | æ˜¾ç¤ºå¸®åŠ©æ€»è§ˆ</li>
          <li><code>npm help &lt;cmd&gt;</code> | æŸ¥çœ‹æŒ‡å®šå‘½ä»¤å¸®åŠ©</li>
          <li><code>npm config list</code> | æŸ¥çœ‹å½“å‰é…ç½®</li>
          <li><code>npm config get registry</code> | æŸ¥çœ‹å½“å‰ registry åœ°å€</li>
          <li><code>npm prefix -g</code> | æŸ¥çœ‹å…¨å±€å®‰è£…è·¯å¾„</li>
          <li><code>npm doctor</code> | æ£€æŸ¥å¸¸è§ç¯å¢ƒé—®é¢˜</li>
        </ul>
        <h3>å¸¸ç”¨ç¯å¢ƒä¿¡æ¯</h3>
        <pre>npm version          # æ˜¾ç¤º npm / node / v8 ç­‰ç‰ˆæœ¬
npm config list -l  # æ˜¾ç¤ºå®Œæ•´é…ç½®
npm root -g         # å…¨å±€ node_modules ç›®å½•</pre>
        <div class="desc">å…ˆç†Ÿæ‚‰ç‰ˆæœ¬ã€å¸®åŠ©ä¸é…ç½®æŸ¥è¯¢ï¼Œå†æ·±å…¥å„å­å‘½ä»¤ä½¿ç”¨ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ“¦ ä¾èµ–å®‰è£…ä¸å¸è½½ <a href="https://docs.npmjs.com/cli/v10/commands/npm-install" title="npm install æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm install</code> | æŒ‰ package.json å®‰è£…å…¨éƒ¨ä¾èµ–</li>
          <li><code>npm install &lt;pkg&gt;</code> | å®‰è£…åˆ° dependencies</li>
          <li><code>npm install &lt;pkg&gt; -D</code> | å®‰è£…åˆ° devDependencies</li>
          <li><code>npm install -g &lt;pkg&gt;</code> | å…¨å±€å®‰è£… CLI å·¥å…·</li>
          <li><code>npm uninstall &lt;pkg&gt;</code> | å¸è½½ä¾èµ–</li>
          <li><code>npm install &lt;pkg&gt;@&lt;version&gt;</code> | å®‰è£…æŒ‡å®šç‰ˆæœ¬</li>
          <li><code>npm install &lt;pkg&gt;@latest</code> | å®‰è£…æœ€æ–°ç¨³å®šç‰ˆ</li>
        </ul>
        <h3>é”å®šä¸é‡è£…ä¾èµ–</h3>
        <pre># ä¸¥æ ¼æŒ‰ç…§ package-lock.json å®‰è£…
npm ci

# æ¸…ç†å¹¶é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install</pre>
        <div class="desc">åŒºåˆ†æœ¬åœ°/å…¨å±€ã€ç”Ÿäº§/å¼€å‘ä¾èµ–ï¼Œæ³¨æ„ use npm ci ä¿è¯å¯é‡å¤æ„å»ºã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ› ï¸ ä¾èµ–æ›´æ–°ä¸å®‰å…¨å®¡è®¡ <a href="https://docs.npmjs.com/cli/v10/commands/npm-update" title="npm update / audit æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm outdated</code> | åˆ—å‡ºå¯æ›´æ–°ä¾èµ–</li>
          <li><code>npm update</code> | æŒ‰ semver èŒƒå›´æ›´æ–°ä¾èµ–</li>
          <li><code>npm update &lt;pkg&gt;</code> | æ›´æ–°æŒ‡å®šä¾èµ–</li>
          <li><code>npm audit</code> | æ‰«æå·²çŸ¥å®‰å…¨æ¼æ´</li>
          <li><code>npm audit fix</code> | è‡ªåŠ¨æ›´æ–°å¯ä¿®å¤æ¼æ´</li>
          <li><code>npm audit fix --force</code> | å…è®¸ç ´åæ€§æ›´æ–°</li>
        </ul>
        <h3>å¸¸è§å‡çº§ç­–ç•¥</h3>
        <pre># ä»…ä¿®è¡¥ BUG / Patch
# package.json ä¸­ä½¿ç”¨ ~1.2.3

# å…¼å®¹å°ç‰ˆæœ¬çš„æ–°ç‰¹æ€§
# package.json ä¸­ä½¿ç”¨ ^1.2.3

# å…¨é‡å‡çº§å¹¶æ‰‹åŠ¨æµ‹è¯•
npm outdated
npm update</pre>
        <div class="desc">ç»“åˆ semver èŒƒå›´ä¸ audit æŠ¥å‘Šï¼Œæ§åˆ¶æ›´æ–°èŠ‚å¥ä¸é£é™©ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ“œ npm scripts ä¸ç”Ÿå‘½å‘¨æœŸ <a href="https://docs.npmjs.com/cli/v10/using-npm/scripts" title="npm scripts æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm run &lt;script&gt;</code> | è¿è¡Œ package.json ä¸­çš„è„šæœ¬</li>
          <li><code>npm test</code> | ç­‰ä»·äº <code>npm run test</code></li>
          <li><code>npm start</code> | ç­‰ä»·äº <code>npm run start</code></li>
          <li><code>npm run lint -- --fix</code> | ç»™è„šæœ¬é€ä¼ å‚æ•°</li>
          <li><code>npm run</code> | åˆ—å‡ºæ‰€æœ‰è„šæœ¬</li>
          <li><code>npm set-script &lt;name&gt; &lt;cmd&gt;</code> | å‘½ä»¤è¡Œæ–°å¢è„šæœ¬</li>
        </ul>
        <h3>è„šæœ¬ä¸ç”Ÿå‘½å‘¨æœŸç¤ºä¾‹</h3>
        <pre>{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "test": "vitest",
    "lint": "eslint src --fix",

    "prepublishOnly": "npm test",
    "postinstall": "node scripts/postinstall.js"
  }
}</pre>
        <div class="desc">ç»Ÿä¸€é€šè¿‡ npm run ç®¡ç†ä»»åŠ¡ï¼Œç»“åˆç”Ÿå‘½å‘¨æœŸè„šæœ¬è‡ªåŠ¨åŒ–æ„å»ºä¸å‘å¸ƒå‰æ£€æŸ¥ã€‚</div>
      </div>

      <div class="card">
        <h2>âš¡ npx ä¸´æ—¶æ‰§è¡Œ CLI å·¥å…· <a href="https://docs.npmjs.com/cli/v10/commands/npx" title="npx æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npx &lt;pkg&gt;</code> | ç›´æ¥æ‰§è¡Œæœ¬åœ°æˆ–è¿œç¨‹åŒ…</li>
          <li><code>npx &lt;pkg&gt;@latest</code> | å§‹ç»ˆä½¿ç”¨åŒ…æœ€æ–°ç‰ˆæœ¬</li>
          <li><code>npx --yes &lt;pkg&gt;</code> | è‡ªåŠ¨ç¡®è®¤å®‰è£…æç¤º</li>
          <li><code>npx --no-install &lt;pkg&gt;</code> | åªä½¿ç”¨å·²æœ‰å®‰è£…ï¼Œä¸è§¦å‘ä¸‹è½½</li>
          <li><code>npx -p &lt;pkg&gt; &lt;cmd&gt;</code> | ä»¥ä¸´æ—¶ä¾èµ–æ–¹å¼æ‰§è¡Œå‘½ä»¤</li>
        </ul>
        <h3>è„šæ‰‹æ¶ä¸ä¸€æ¬¡æ€§å‘½ä»¤</h3>
        <pre># åˆ›å»ºæ–°é¡¹ç›®
npx create-vite@latest my-app
npx create-next-app@latest my-app

# ä¸€æ¬¡æ€§ä»£ç æ£€æŸ¥
npx eslint . --ext .js,.ts

# æŒ‡å®š node é€‰é¡¹
NODE_OPTIONS=\"--max_old_space_size=4096\" npx jest</pre>
        <div class="desc">npx é€‚åˆä¸€æ¬¡æ€§è„šæ‰‹æ¶ä¸å·¥å…·ï¼Œä¸æ±¡æŸ“å…¨å±€ç¯å¢ƒï¼ŒåŒæ—¶å¤ç”¨æœ¬åœ°ç¼“å­˜ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸŒ registry ä¸ç¼“å­˜ç®¡ç† <a href="https://docs.npmjs.com/cli/v10/commands/npm-config" title="npm é…ç½®ä¸ç¼“å­˜" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm config get registry</code> | æŸ¥çœ‹å½“å‰æº</li>
          <li><code>npm config set registry &lt;url&gt;</code> | è®¾ç½®æ–°æº</li>
          <li><code>npm config delete registry</code> | æ¢å¤é»˜è®¤ registry</li>
          <li><code>npm cache verify</code> | æ£€æŸ¥ç¼“å­˜å®Œæ•´æ€§</li>
          <li><code>npm cache clean --force</code> | æ¸…ç†æœ¬åœ°ç¼“å­˜</li>
        </ul>
        <h3>.npmrc é…ç½®ç¤ºä¾‹</h3>
        <pre># ç”¨æˆ·çº§ ~/.npmrc
registry=https://registry.npmjs.org/
audit=true
save-prefix=^

# é¡¹ç›®çº§ .npmrc
legacy-peer-deps=false
engine-strict=true</pre>
        <div class="desc">é€šè¿‡ .npmrc ç»Ÿä¸€ç®¡ç† registryã€å®¡è®¡ä¸å®‰è£…ç­–ç•¥ï¼Œç¼“å­˜å¼‚å¸¸æ—¶é€‚åº¦æ¸…ç†ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸš¢ å‘å¸ƒä¸ç‰ˆæœ¬ç®¡ç† <a href="https://docs.npmjs.com/cli/v10/commands/npm-publish" title="å‘å¸ƒä¸ç‰ˆæœ¬æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm login</code> | ç™»å½• npm registry</li>
          <li><code>npm whoami</code> | æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·</li>
          <li><code>npm version &lt;major|minor|patch&gt;</code> | è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·ä¸ tag</li>
          <li><code>npm publish</code> | å‘å¸ƒåŒ…åˆ° registry</li>
          <li><code>npm publish --tag next</code> | å‘å¸ƒåˆ°è‡ªå®šä¹‰æ ‡ç­¾</li>
          <li><code>npm dist-tag add pkg@1.2.3 next</code> | æ‰‹åŠ¨æ·»åŠ  dist-tag</li>
          <li><code>npm unpublish pkg@1.2.3</code> | æ’¤å›æŒ‡å®šç‰ˆæœ¬ï¼ˆéœ€è°¨æ…ï¼‰</li>
        </ul>
        <h3>å‘å¸ƒæµç¨‹ç¤ºä¾‹</h3>
        <pre># 1. ç¡®è®¤å·¥ä½œåŒºå¹²å‡€
git status

# 2. è¿è¡Œæµ‹è¯•ä¸æ„å»º
npm test
npm run build

# 3. æ›´æ–°ç‰ˆæœ¬å¹¶æ‰“ tag
npm version patch

# 4. å‘å¸ƒåˆ° npm
npm publish</pre>
        <div class="desc">ä»¥ npm version ç®¡ç†ç‰ˆæœ¬ä¸ Git tagï¼Œé…åˆ dist-tag æ§åˆ¶ç°åº¦ä¸ç¨³å®šé€šé“ã€‚</div>
      </div>

      <div class="card">
        <h2>ğŸ—ï¸ Workspaces å¤šåŒ…ç®¡ç† <a href="https://docs.npmjs.com/cli/v10/using-npm/workspaces" title="Workspaces æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>\"workspaces\" å­—æ®µ</code> | åœ¨ package.json ä¸­å£°æ˜å­åŒ…</li>
          <li><code>npm install -w &lt;ws&gt;</code> | åœ¨æŒ‡å®š workspace å®‰è£…ä¾èµ–</li>
          <li><code>npm run &lt;script&gt; -w &lt;ws&gt;</code> | åœ¨å•ä¸ª workspace è¿è¡Œè„šæœ¬</li>
          <li><code>npm run &lt;script&gt; --workspaces</code> | åœ¨æ‰€æœ‰ workspace æ‰§è¡Œè„šæœ¬</li>
          <li><code>npm exec -w &lt;ws&gt; &lt;cmd&gt;</code> | åœ¨æŒ‡å®š workspace æ‰§è¡Œå‘½ä»¤</li>
        </ul>
        <h3>æ ¹ package.json ç¤ºä¾‹</h3>
        <pre>{
  "private": true,
  "workspaces": [
    "packages/*",
    "apps/*"
  ],
  "scripts": {
    "build": "npm run build --workspaces",
    "test": "npm run test --workspaces"
  }
}</pre>
        <div class="desc">Workspaces é€‚åˆå¤šåŒ…ä»“åº“ï¼Œç»Ÿä¸€ç®¡ç†ä¾èµ–ä¸è„šæœ¬ï¼Œå‡å°‘é‡å¤å®‰è£…ã€‚</div>
      </div>
    </div>
  </div>

  <!-- ç»Ÿä¸€ä½¿ç”¨å…¬å…±è„šæœ¬ç®¡ç†åˆ—å®½æ»‘å—é€»è¾‘ -->
  <script src="../../assets/common.js"></script>
</body>
</html>
