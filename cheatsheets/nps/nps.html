<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>npså¼€å‘å‘½ä»¤é€ŸæŸ¥è¡¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../assets/variables.css">
  <link rel="stylesheet" href="../../assets/global.css">
  <link rel="stylesheet" href="../../assets/cheatsheet.css">
  <link rel="icon" type="image/png" href="../../assets/brand/cheatsheet.png" />
  <link rel="apple-touch-icon" href="../../assets/brand/cheatsheet.png" />
  <style>
    :root {
      --colWidth: 340px;
      --gap: 16px;
    }
    .panel label {
      color: var(--panel-accent);
    }
    .panel .title {
      color: var(--panel-accent);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <span class="title">ğŸ”§ npsè„šæœ¬ç®¡ç†é€ŸæŸ¥è¡¨</span>
      <label for="columnWidth">ğŸ”§ è°ƒæ•´æ¯åˆ—å®½åº¦ï¼š</label>
      <input id="columnWidth" class="slider-bar" type="range" min="300" max="660" value="340">
      <span id="widthVal" class="slider-val">340px</span>
    </div>
    <div class="cheat-columns" id="columns">
      <div class="card">
        <h2>ğŸ“¦ å®‰è£…ä¸åˆå§‹åŒ– <a href="https://github.com/kentcdodds/nps#installation" title="å®‰è£…æŒ‡å—" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>npm install --save-dev nps</code> | é¡¹ç›®çº§å®‰è£…</li>
          <li><code>npm install -g nps</code> | å…¨å±€å®‰è£…</li>
          <li><code>npm install nps-utils</code> | å®‰è£…å·¥å…·åº“</li>
        </ul>
        <h3>é¡¹ç›®åˆå§‹åŒ–</h3>
        <pre># ä»package.jsonè¿ç§»åˆ°nps
./node_modules/.bin/nps init

# æˆ–ä½¿ç”¨npx
npx nps init

# ç”Ÿæˆpackage-scripts.js
# è‡ªåŠ¨è¿ç§»ç°æœ‰è„šæœ¬</pre>
        <div class="desc">nps initä¼šè‡ªåŠ¨å°†package.jsonä¸­çš„scriptsè¿ç§»åˆ°package-scripts.js</div>
      </div>

      <div class="card">
        <h2>âš™ï¸ é…ç½®æ–‡ä»¶ç»“æ„ <a href="https://github.com/kentcdodds/nps#configuration" title="é…ç½®æ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>package-scripts.js</code> | JavaScripté…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰</li>
          <li><code>package-scripts.yml</code> | YAMLé…ç½®æ–‡ä»¶</li>
          <li><code>scripts</code> | æ ¹çº§è„šæœ¬é…ç½®</li>
        </ul>
        <h3>JavaScripté…ç½®ç¤ºä¾‹</h3>
        <pre>const { series, rimraf, crossEnv } = require('nps-utils')

module.exports = {
  scripts: {
    default: "node index.js",
    clean: rimraf('dist'),
    build: series.nps('clean', 'webpack'),
    start: crossEnv('NODE_ENV=production', 'node server.js'),
    test: 'jest --coverage',
    lint: {
      js: "eslint .",
      css: "stylelint '**/*.css'"
    }
  }
}</pre>
        <div class="desc">JavaScripté…ç½®æ”¯æŒå¤æ‚é€»è¾‘å’Œä»£ç å¤ç”¨</div>
      </div>

      <div class="card">
        <h2>ğŸ“ YAMLé…ç½®æ”¯æŒ <a href="https://github.com/kentcdodds/nps#yaml-configuration" title="YAMLé…ç½®" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>scripts</code> | å®šä¹‰è„šæœ¬å‘½ä»¤</li>
          <li><code>æ•°ç»„æ ¼å¼</code> | æ”¯æŒæŒ‰é¡ºåºæ‰§è¡Œå¤šä¸ªå‘½ä»¤</li>
          <li><code>åµŒå¥—ç»“æ„</code> | æ”¯æŒç‚¹è¯­æ³•è®¿é—®</li>
        </ul>
        <h3>YAMLé…ç½®ç¤ºä¾‹</h3>
        <pre>scripts:
  default: node index.js
  lint: eslint .
  test: jest
  build:
    - rimraf dist
    - webpack
  start:
    - cross-env NODE_ENV=production
    - node server.js
  clean:
    - rm -rf node_modules
    - npm install</pre>
        <div class="desc">YAMLé…ç½®æ›´ç®€æ´ï¼Œé€‚åˆç®€å•é¡¹ç›®</div>
      </div>

      <div class="card">
        <h2>ğŸ› ï¸ nps-utilså·¥å…·åº“ <a href="https://github.com/kentcdodds/nps-utils" title="nps-utilsæ–‡æ¡£" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>series</code> | ä¸²è¡Œæ‰§è¡Œè„šæœ¬</li>
          <li><code>parallel</code> | å¹¶è¡Œæ‰§è¡Œè„šæœ¬</li>
          <li><code>rimraf</code> | è·¨å¹³å°åˆ é™¤æ–‡ä»¶</li>
          <li><code>crossEnv</code> | è·¨å¹³å°ç¯å¢ƒå˜é‡</li>
        </ul>
        <h3>å·¥å…·åº“ç”¨æ³•ç¤ºä¾‹</h3>
        <pre>const {
  series,
  parallel,
  rimraf,
  crossEnv,
  nps
} = require('nps-utils')

module.exports = {
  scripts: {
    // ä¸²è¡Œæ‰§è¡Œï¼šclean -> build
    build: series.nps('clean', 'webpack'),

    // å¹¶è¡Œæ‰§è¡Œï¼šlint & test
    test: parallel.nps('lint', 'unit'),

    // è·¨å¹³å°åˆ é™¤
    clean: rimraf('dist'),

    // ç¯å¢ƒå˜é‡
    start: crossEnv('NODE_ENV=production', 'node server.js'),

    // åµŒå¥—è°ƒç”¨
    deploy: series.nps('build', 'start')
  }
}</pre>
        <div class="desc">nps-utilsæä¾›è·¨å¹³å°å…¼å®¹çš„å·¥å…·å‡½æ•°</div>
      </div>

      <div class="card">
        <h2>ğŸ“‹ CLIå‘½ä»¤ä½¿ç”¨ <a href="https://github.com/kentcdodds/nps#usage" title="CLIä½¿ç”¨" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>nps</code> | è¿è¡Œdefaultè„šæœ¬</li>
          <li><code>nps help</code> | æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨è„šæœ¬</li>
          <li><code>nps script.name</code> | è¿è¡ŒåµŒå¥—è„šæœ¬</li>
          <li><code>nps b</code> | ä½¿ç”¨å‰ç¼€å¿«æ·å‘½ä»¤</li>
        </ul>
        <h3>å‘½ä»¤æ‰§è¡Œç¤ºä¾‹</h3>
        <pre># è¿è¡Œé»˜è®¤è„šæœ¬
nps

# è¿è¡ŒæŒ‡å®šè„šæœ¬
nps build
nps test

# è¿è¡ŒåµŒå¥—è„šæœ¬
nps lint.js
nps lint.css

# ä½¿ç”¨å‰ç¼€å¿«æ·
nps b              # ç­‰åŒäº nps build
nps t              # ç­‰åŒäº nps test
nps help b          # æ˜¾ç¤ºbuildè„šæœ¬å¸®åŠ©ä¿¡æ¯</pre>
        <div class="desc">å‰ç¼€åŠŸèƒ½è®©è„šæœ¬è°ƒç”¨æ›´å¿«æ·</div>
      </div>

      <div class="card">
        <h2>ğŸ”Œ ç¯å¢ƒå˜é‡é…ç½® <a href="https://github.com/kentcdodds/nps#environment-variables" title="ç¯å¢ƒå˜é‡" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>LOG_LEVEL</code> | æ§åˆ¶è¾“å‡ºè¯¦ç»†ç¨‹åº¦</li>
          <li><code>NPS_PACKAGE_MANAGER</code> | æŒ‡å®šåŒ…ç®¡ç†å™¨</li>
          <li><code>NODE_ENV</code> | Node.jsç¯å¢ƒå˜é‡</li>
        </ul>
        <h3>ç¯å¢ƒå˜é‡è®¾ç½®</h3>
        <pre># è®¾ç½®æ—¥å¿—çº§åˆ«
export LOG_LEVEL=silent    # é™é»˜æ¨¡å¼
export LOG_LEVEL=info      # é»˜è®¤çº§åˆ«
export LOG_LEVEL=debug     # è°ƒè¯•æ¨¡å¼

# æŒ‡å®šåŒ…ç®¡ç†å™¨
export NPS_PACKAGE_MANAGER=pnpm

# ä¸´æ—¶è®¾ç½®
LOG_LEVEL=debug nps build</pre>
        <div class="desc">ç¯å¢ƒå˜é‡æ§åˆ¶npsçš„è¡Œä¸ºå’Œè¾“å‡º</div>
      </div>

      <div class="card">
        <h2>ğŸ—ï¸ é«˜çº§è„šæœ¬æ¨¡å¼ <a href="https://github.com/kentcdodds/nps#advanced-usage" title="é«˜çº§ç”¨æ³•" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>æ¡ä»¶æ‰§è¡Œ</code> | åŸºäºç¯å¢ƒå˜é‡çš„æ¡ä»¶è„šæœ¬</li>
          <li><code>åŠ¨æ€è„šæœ¬</code> | è¿è¡Œæ—¶ç”Ÿæˆè„šæœ¬å‘½ä»¤</li>
          <li><code>è„šæœ¬ç»„åˆ</code> | å¤æ‚çš„è„šæœ¬ç¼–æ’</li>
        </ul>
        <h3>é«˜çº§ç”¨æ³•ç¤ºä¾‹</h3>
        <pre>const { series, parallel, crossEnv } = require('nps-utils')

module.exports = {
  scripts: {
    // æ¡ä»¶æ‰§è¡Œ
    build: process.env.NODE_ENV === 'production'
      ? series.nps('clean', 'webpack:prod')
      : series.nps('clean', 'webpack:dev'),

    // åŠ¨æ€è„šæœ¬
    test: `jest --coverage${process.env.CI ? ' --watchAll=false' : ''}`,

    // å¤æ‚ç¼–æ’
    deploy: series(
      crossEnv('NODE_ENV=production'),
      parallel.nps('build', 'test'),
      'npm publish'
    ),

    // ç¯å¢ƒç‰¹å®š
    'build:prod': crossEnv('NODE_ENV=production', 'webpack --mode production'),
    'build:dev': crossEnv('NODE_ENV=development', 'webpack --mode development')
  }
}</pre>
        <div class="desc">JavaScripté…ç½®æä¾›å¼ºå¤§çš„çµæ´»æ€§</div>
      </div>

      <div class="card">
        <h2>ğŸ”„ è„šæœ¬ç»§æ‰¿ä¸æ‰©å±• <a href="https://github.com/kentcdodds/nps#inheritance" title="ç»§æ‰¿æœºåˆ¶" target="_blank" style="color:#93cdfc;">>></a></h2>
        <ul>
          <li><code>extends</code> | ç»§æ‰¿å…¶ä»–é…ç½®æ–‡ä»¶</li>
          <li><code>scriptsè¦†ç›–</code> | é‡å†™ç»§æ‰¿çš„è„šæœ¬</li>
          <li><code>merge</code> | åˆå¹¶å¤šä¸ªé…ç½®</li>
        </ul>
        <h3>é…ç½®ç»§æ‰¿ç¤ºä¾‹</h3>
        <pre>// base-scripts.js
module.exports = {
  scripts: {
    clean: 'rimraf dist',
    lint: 'eslint .',
    test: 'jest'
  }
}

// package-scripts.js
const baseScripts = require('./base-scripts')

module.exports = {
  ...baseScripts,
  scripts: {
    ...baseScripts.scripts,
    build: series.nps('clean', 'webpack'),
    deploy: series.nps('build', 'upload')
  }
}</pre>
        <div class="desc">ç»§æ‰¿æœºåˆ¶æ”¯æŒé…ç½®çš„æ¨¡å—åŒ–å’Œå¤ç”¨</div>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('columnWidth').addEventListener('input', function(e) {
      const width = e.target.value;
      document.getElementById('widthVal').textContent = width + 'px';
      const columns = document.getElementById('columns');
      columns.style.columnWidth = width + 'px';
    });
  </script>
</body>
</html>